<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>`rsyncrosim`: introduction to spatial data • rsyncrosim</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="`rsyncrosim`: introduction to spatial data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rsyncrosim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/a01_rsyncrosim_vignette_basic.html">Introduction to `rsyncrosim`</a></li>
    <li><a class="dropdown-item" href="../articles/a02_rsyncrosim_vignette_uncertainty.html">`rsyncrosim`: introduction to uncertainty</a></li>
    <li><a class="dropdown-item" href="../articles/a03_rsyncrosim_vignette_pipelines.html">`rsyncrosim`: introduction to pipelines</a></li>
    <li><a class="dropdown-item" href="../articles/a04_rsyncrosim_vignette_spatial.html">`rsyncrosim`: introduction to spatial data</a></li>
    <li><a class="dropdown-item" href="../articles/a05_rsyncrosim_stsim_vignette.html">`rsyncrosim`: introduction to `ST-Sim`</a></li>
    <li><a class="dropdown-item" href="../articles/a06_rsyncrosim_install_github.html">Installing GitHub release</a></li>
    <li><a class="dropdown-item" href="../articles/using-conda-with-rsyncrosim.html">Conda Demo</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/syncrosim/rsyncrosim/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>`rsyncrosim`: introduction to spatial data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/syncrosim/rsyncrosim/blob/HEAD/vignettes/a04_rsyncrosim_vignette_spatial.Rmd" class="external-link"><code>vignettes/a04_rsyncrosim_vignette_spatial.Rmd</code></a></small>
      <div class="d-none name"><code>a04_rsyncrosim_vignette_spatial.Rmd</code></div>
    </div>

    
    
<p>This vignette will cover incorporating spatial data into SyncroSim
models using the <code>rsyncrosim</code> package within the
<a href="https://syncrosim.com/" target="_blank" class="external-link">SyncroSim</a> software
framework. For an overview of
<a href="https://syncrosim.com/" target="_blank" class="external-link">SyncroSim</a> and
<a href="https://cran.r-project.org/web/packages/rsyncrosim/index.html" target="_blank" class="external-link"><code>rsyncrosim</code></a>,
as well as a basic usage tutorial for <code>rsyncrosim</code>, see the
<a href="https://syncrosim.github.io/rsyncrosim/articles/a01_rsyncrosim_vignette_basic.html" target="_blank">Introduction
to <code>rsyncrosim</code></a> vignette. To learn how to use iterations
in the <code>rsyncrosim</code> interface, see the
<a href="https://syncrosim.github.io/rsyncrosim/articles/a02_rsyncrosim_vignette_uncertainty.html" target="_blank"><code>rsyncrosim</code>:
introduction to uncertainty</a> vignette. To learn how to link models
using pipelines in the <code>rsyncrosim</code> interface, see the
<a href="https://syncrosim.github.io/rsyncrosim/articles/a03_rsyncrosim_vignette_pipelines.html" target="_blank"><code>rsyncrosim</code>:
introduction to pipelines</a> vignette.</p>
<div class="section level2">
<h2 id="syncrosim-package-helloworldspatial">SyncroSim Package: helloworldSpatial<a class="anchor" aria-label="anchor" href="#syncrosim-package-helloworldspatial"></a>
</h2>
<p>To demonstrate how to use spatial data in the <code>rsyncrosim</code>
interface, we will be using the
<a href="https://github.com/ApexRMS/helloworldSpatial" target="_blank" class="external-link">helloworldSpatial</a>
SyncroSim package. <code>helloworldSpatial</code> was designed to be a
simple package to show off some key functionalities of SyncroSim,
including the ability to use both spatial and non-spatial data.</p>
<p>The package takes 3 inputs, <em>mMean</em>, <em>mSD</em>, and a
spatial raster file of intercept (<em>b</em>) values. For each
iteration, a value <em>m</em>, representing the slope, is sampled from a
normal distribution with mean of <em>mMean</em> and standard deviation
of <em>mSD</em>. These values are run through 2 models to produce both
spatial and non-spatial outputs.</p>
<div class="float">
<img src="infographic-spatial.png" width="600" alt="Infographic of helloworldSpatial package"><div class="figcaption">Infographic of helloworldSpatial package</div>
</div>
<p>For more details on the different features of the
<code>helloworldSpatial</code> SyncroSim package, consult the SyncroSim
<a href="https://docs.syncrosim.com/how_to_guides/package_create_spatial.html" target="_blank" class="external-link">Enhancing
a Package: Integrating Spatial Data</a> tutorial.</p>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="section level3">
<h3 id="install-syncrosim">Install SyncroSim<a class="anchor" aria-label="anchor" href="#install-syncrosim"></a>
</h3>
<p>Before using <code>rsyncrosim</code> you will first need to
<a href="https://syncrosim.com/download/" target="_blank" class="external-link">download and
install</a> the SyncroSim software. Versions of SyncroSim exist for both
Windows and Linux.</p>
<p><em>Note</em>: this tutorial was developed using
<code>rsyncrosim</code> version 2.0. To use <code>rsyncrosim</code>
version 2.0 or greater, SyncroSim version 3.0 or greater is
required.</p>
</div>
<div class="section level3">
<h3 id="installing-and-loading-r-packages">Installing and loading R packages<a class="anchor" aria-label="anchor" href="#installing-and-loading-r-packages"></a>
</h3>
<p>You will need to install the <code>rsyncrosim</code> R package,
either using
<a href="https://cran.r-project.org/" target="_blank" class="external-link">CRAN</a> or from
the <code>rsyncrosim</code>
<a href="https://github.com/syncrosim/rsyncrosim/releases/" target="_blank" class="external-link">GitHub
repository</a>. Versions of <code>rsyncrosim</code> are available for
both Windows and Linux. You may need to install the <code>terra</code>
package from CRAN as well.</p>
<p>In a new R script, load the necessary packages. This includes the
<code>rsyncrosim</code> and <code>terra</code> R packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load R packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">rsyncrosim</span><span class="op">)</span>  <span class="co"># package for working with SyncroSim</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span>       <span class="co"># package for working with spatial data</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="connecting-r-to-syncrosim-using-session">Connecting R to SyncroSim using <code>session()</code><a class="anchor" aria-label="anchor" href="#connecting-r-to-syncrosim-using-session"></a>
</h3>
<p>Finish setting up the R environment for the <code>rsyncrosim</code>
workflow by creating a SyncroSim Session object. Use the
<code><a href="../reference/session.html">session()</a></code> function to connect R to your installed copy of
the SyncroSim software.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mySession</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/session.html">session</a></span><span class="op">(</span><span class="st">"path/to/install_folder"</span><span class="op">)</span>      <span class="co"># Create a Session based SyncroSim install folder</span></span>
<span><span class="va">mySession</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/session.html">session</a></span><span class="op">(</span><span class="op">)</span>                              <span class="co"># Using default install folder (Windows only)</span></span>
<span><span class="va">mySession</span>                                           <span class="co"># Displays the Session object</span></span></code></pre></div>
<pre><code><span><span class="co">## class               : Session</span></span>
<span><span class="co">## filepath [character]: C:/Program Files/SyncroSim Studio</span></span>
<span><span class="co">## silent [logical]    : TRUE</span></span>
<span><span class="co">## printCmd [logical]  : FALSE</span></span>
<span><span class="co">## condaFilepath [NULL]:</span></span></code></pre>
<p>Use the <code><a href="../reference/version.html">version()</a></code> function to ensure you are using the
latest version of SyncroSim.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/version.html">version</a></span><span class="op">(</span><span class="va">mySession</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "3.0.9"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="installing-syncrosim-packages-using-installpackage">Installing SyncroSim packages using
<code>installPackage()</code><a class="anchor" aria-label="anchor" href="#installing-syncrosim-packages-using-installpackage"></a>
</h3>
<p>Install <code>helloworldSpatial</code> using the
<code>rynscrosim</code> function <code><a href="../reference/installPackage.html">installPackage()</a></code>. This
function takes a package name as input and then queries the SyncroSim
package server for the specified package.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install helloworldSpatial</span></span>
<span><span class="fu"><a href="../reference/installPackage.html">installPackage</a></span><span class="op">(</span><span class="st">"helloworldSpatial"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Package &lt;helloworldSpatial v2.0.0&gt; installed</span></span></code></pre>
<p><code>helloworldSpatial</code> should now be included in the package
list returned by the <code><a href="../reference/packages.html">packages()</a></code> function in
<code>rsyncrosim</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get list of installed packages</span></span>
<span><span class="fu"><a href="../reference/packages.html">packages</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                name version</span></span>
<span><span class="co">## 1 helloworldSpatial   2.0.0</span></span>
<span><span class="co">##                                                     description</span></span>
<span><span class="co">## 1 Example demonstrating how to use spatial data with an R model</span></span>
<span><span class="co">##                                                                                 location</span></span>
<span><span class="co">## 1 C:\\Users\\birch\\AppData\\Local\\SyncroSim Studio\\Packages\\helloworldSpatial\\2.0.0</span></span>
<span><span class="co">##   status</span></span>
<span><span class="co">## 1     OK</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="create-a-modeling-workflow">Create a modeling workflow<a class="anchor" aria-label="anchor" href="#create-a-modeling-workflow"></a>
</h2>
<p>When creating a new modeling workflow from scratch, we need to create
objects of the following scopes:</p>
<ul>
<li><a href="https://docs.syncrosim.com/how_to_guides/library_overview.html" target="_blank" class="external-link">Library</a></li>
<li><a href="https://docs.syncrosim.com/how_to_guides/library_overview.html" target="_blank" class="external-link">Projects</a></li>
<li><a href="https://docs.syncrosim.com/how_to_guides/library_overview.html" target="_blank" class="external-link">Scenarios</a></li>
</ul>
<p>For more information on these scopes, see the <a href="https://syncrosim.github.io/rsyncrosim/rsyncrosim_vignette_basic.html">Introduction
to <code>rsyncrosim</code></a> vignette.</p>
<div class="section level3">
<h3 id="set-up-library-project-and-scenario">Set up library, project, and scenario<a class="anchor" aria-label="anchor" href="#set-up-library-project-and-scenario"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a new library</span></span>
<span><span class="va">myLibrary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ssimLibrary.html">ssimLibrary</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"helloworldLibrary.ssim"</span>,</span>
<span>                         session <span class="op">=</span> <span class="va">mySession</span>,</span>
<span>                         package <span class="op">=</span> <span class="st">"helloworldSpatial"</span>,</span>
<span>                         overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Package &lt;helloworldSpatial v2.0.0&gt; added</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Open the default project</span></span>
<span><span class="va">myProject</span> <span class="op">=</span> <span class="fu">rsyncrosim</span><span class="fu">::</span><span class="fu"><a href="../reference/project.html">project</a></span><span class="op">(</span>ssimObject <span class="op">=</span> <span class="va">myLibrary</span>, project <span class="op">=</span> <span class="st">"Definitions"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a new scenario (associated with the default project)</span></span>
<span><span class="va">myScenario</span> <span class="op">=</span> <span class="fu"><a href="../reference/scenario.html">scenario</a></span><span class="op">(</span>ssimObject <span class="op">=</span> <span class="va">myProject</span>, scenario <span class="op">=</span> <span class="st">"My spatial scenario"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="view-model-inputs-using-datasheet">View model inputs using <code>datasheet()</code><a class="anchor" aria-label="anchor" href="#view-model-inputs-using-datasheet"></a>
</h3>
<p>View the datasheets associated with your new scenario using the
<code><a href="../reference/datasheet.html">datasheet()</a></code> function from <code>rsyncrosim</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># View all datasheets associated with a library, project, or scenario</span></span>
<span><span class="fu"><a href="../reference/datasheet.html">datasheet</a></span><span class="op">(</span><span class="va">myScenario</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       scope                                    name             displayName</span></span>
<span><span class="co">## 23 scenario                  core_DistributionValue           Distributions</span></span>
<span><span class="co">## 24 scenario              core_ExternalVariableValue      External Variables</span></span>
<span><span class="co">## 25 scenario                           core_Pipeline                Pipeline</span></span>
<span><span class="co">## 26 scenario             core_SpatialMultiprocessing Spatial Multiprocessing</span></span>
<span><span class="co">## 27 scenario        helloworldSpatial_InputDatasheet                  Inputs</span></span>
<span><span class="co">## 28 scenario helloworldSpatial_IntermediateDatasheet    Intermediate Outputs</span></span>
<span><span class="co">## 29 scenario       helloworldSpatial_OutputDatasheet                 Outputs</span></span>
<span><span class="co">## 30 scenario            helloworldSpatial_RunControl             Run Control</span></span></code></pre>
<p>From the list of datasheets above, we can see that there are four
datasheets specific to the <code>helloworldSpatial</code> package,
including an <code>Inputs</code> datasheet, an
<code>Intermediate Outputs</code> datasheet, an <code>Outputs</code>
datasheet, and a <code>Run Control</code> datasheet.</p>
</div>
<div class="section level3">
<h3 id="configure-model-inputs-using-datasheet-and-addrow">Configure model inputs using <code>datasheet()</code> and
<code>addRow()</code><a class="anchor" aria-label="anchor" href="#configure-model-inputs-using-datasheet-and-addrow"></a>
</h3>
<p>Currently our input scenario datasheets are empty! We need to add
some values to our <code>Inputs</code> datasheet,
<code>Run Control</code> datasheet, and <code>Pipeline</code> datasheet
so we can run our model.</p>
<p><strong>Inputs datasheet</strong></p>
<p>First, assign the contents of the <code>Inputs</code> datasheet to a
new data frame variable using <code><a href="../reference/datasheet.html">datasheet()</a></code>, then check the
columns that need input values.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load Inputs datasheet to a new R data frame</span></span>
<span><span class="va">myInputDataframe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datasheet.html">datasheet</a></span><span class="op">(</span><span class="va">myScenario</span>,</span>
<span>                              name <span class="op">=</span> <span class="st">"helloworldSpatial_InputDatasheet"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check the columns of the input data frame</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">myInputDataframe</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 'data.frame':    0 obs. of  3 variables:</span></span>
<span><span class="co">##  $ mMean              : num </span></span>
<span><span class="co">##  $ mSD                : num </span></span>
<span><span class="co">##  $ InterceptRasterFile: chr</span></span></code></pre>
<p>The <code>Inputs</code> datasheet requires three values:</p>
<ul>
<li>
<code>mMean</code> : the mean of a normal distribution that will
determine the slope of the linear equation.</li>
<li>
<code>mSD</code> : the standard deviation of a normal distribution
that will determine the slope of the linear equation.</li>
<li>
<code>InterceptRasterFile</code> : the file path to a <em>raster
image</em>, in which each cell of the image will be an intercept in the
linear equation.</li>
</ul>
<p>In this example, the external file we are using for the
<code>InterceptRasterFile</code> is a simple 5x5 raster TIF file
generated using the <code>raster</code> package in R. The file used in
this vignette can be found
<a href="https://github.com/ApexRMS/helloworldSpatial/blob/main/images/input-raster.tif" target="_blank" class="external-link">here</a>.</p>
<div class="float">
<img src="input-raster.png" alt="InterceptRasterFile input image"><div class="figcaption">InterceptRasterFile input image</div>
</div>
<p>Add these values to a new data frame, then use the
<code><a href="../reference/addRow.html">addRow()</a></code> function from <code>rsyncrosim</code> to update
the input data frame</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create input data and add it to the input data frame</span></span>
<span><span class="va">myInputRow</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>mMean <span class="op">=</span> <span class="fl">0</span>, </span>
<span>                         mSD <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                         InterceptRasterFile <span class="op">=</span> <span class="st">"path/to/input-raster.tif"</span><span class="op">)</span></span>
<span><span class="va">myInputDataframe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addRow.html">addRow</a></span><span class="op">(</span><span class="va">myInputDataframe</span>, <span class="va">myInputRow</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check values</span></span>
<span><span class="va">myInputDataframe</span></span></code></pre></div>
<pre><code><span><span class="co">##   mMean mSD      InterceptRasterFile</span></span>
<span><span class="co">## 1     0   4 path/to/input-raster.tif</span></span></code></pre>
<p>Finally, save the updated R data frame to a SyncroSim datasheet using
<code><a href="../reference/saveDatasheet.html">saveDatasheet()</a></code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Save input R data frame as a SyncroSim datasheet</span></span>
<span><span class="fu"><a href="../reference/saveDatasheet.html">saveDatasheet</a></span><span class="op">(</span>ssimObject <span class="op">=</span> <span class="va">myScenario</span>, </span>
<span>              data <span class="op">=</span> <span class="va">myInputDataframe</span>,</span>
<span>              name <span class="op">=</span> <span class="st">"helloworldSpatial_InputDatasheet"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Datasheet &lt;helloworldSpatial_InputDatasheet&gt; saved</span></span></code></pre>
<p><strong>Run Control datasheet</strong></p>
<p>The <code>Run Control</code> datasheet sets the number of iterations
and the minimum and maximum time steps for our model. We’ll assign the
contents of this datasheet to a new data frame variable as well and then
add then update the information in the data frame using
<code><a href="../reference/addRow.html">addRow()</a></code>. We need to specify data for the following four
columns:</p>
<ul>
<li>
<code>MaximumIteration</code> : total number of iterations to run
the model for.</li>
<li>
<code>MinimumTimestep</code> : the starting time point of the
simulation.</li>
<li>
<code>MaximumTimestep</code> : the end time point of the
simulation.</li>
</ul>
<p><em>Note:</em> A fourth hidden column, <code>MinimumIteration</code>,
also exists in the <code>Run Control</code> datasheet (default=1).</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load Run Control datasheet to an R data frame</span></span>
<span><span class="va">runSettings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datasheet.html">datasheet</a></span><span class="op">(</span><span class="va">myScenario</span>, name <span class="op">=</span> <span class="st">"helloworldSpatial_RunControl"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check the columns of the Run Control data frame</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">runSettings</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 'data.frame':    0 obs. of  3 variables:</span></span>
<span><span class="co">##  $ MinimumTimestep : num </span></span>
<span><span class="co">##  $ MaximumTimestep : num </span></span>
<span><span class="co">##  $ MaximumIteration: num</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create Run Control data and add it to the Run Control data frame</span></span>
<span><span class="va">runSettingsRow</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>MaximumIteration <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                             MinimumTimestep <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                             MaximumTimestep <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">runSettings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addRow.html">addRow</a></span><span class="op">(</span><span class="va">runSettings</span>, <span class="va">runSettingsRow</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check values</span></span>
<span><span class="va">runSettings</span></span></code></pre></div>
<pre><code><span><span class="co">##   MinimumTimestep MaximumTimestep MaximumIteration</span></span>
<span><span class="co">## 1               1              10                5</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Save Run Control R data frame to a SyncroSim datasheet</span></span>
<span><span class="fu"><a href="../reference/saveDatasheet.html">saveDatasheet</a></span><span class="op">(</span>ssimObject <span class="op">=</span> <span class="va">myScenario</span>, </span>
<span>              data <span class="op">=</span> <span class="va">runSettings</span>,</span>
<span>              name <span class="op">=</span> <span class="st">"helloworldSpatial_RunControl"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Datasheet &lt;helloworldSpatial_RunControl&gt; saved</span></span></code></pre>
<p><strong>Pipeline datasheet</strong></p>
<p>The <code>helloworldSpatial</code> package uses pipelines to link the
output of one model to the input of a second model. To learn more about
pipelines, see the <a href="https://syncrosim.github.io/rsyncrosim/rsyncrosim_vignette_pipelines.html"><code>rsyncrosim</code>:
introduction to pipelines</a> vignette and the SyncroSim
<a href="https://docs.syncrosim.com/how_to_guides/package_create_pipelines.html" target="_blank" class="external-link">Enhancing
a Package: Linking Models</a> tutorial.</p>
<p>To implement pipelines in our package, we need to specify the order
in which to run the transformers (i.e. models) in our pipeline by
editing the <code>Pipeline</code> datasheet. The <code>Pipeline</code>
datasheet is part of the built-in SyncroSim core, so we access it using
the “core_” prefix with the <code><a href="../reference/datasheet.html">datasheet()</a></code> function.</p>
<p>From viewing the structure of the <code>Pipeline</code> datasheet we
know that the <code>StageNameId</code> is a factor with two levels:</p>
<ul>
<li>Hello World Spatial 1 (R)</li>
<li>Hello World Spatial 2 (R)</li>
</ul>
<p>We will set the data for this datasheet such that
<code>Hello World Spatial 1 (R)</code> is run first, then
<code>Hello World Spatial 2 (R)</code>. This way, the output from
<code>Hello World Spatial 1 (R)</code> is used as the input for
<code>Hello World Spatial 2 (R)</code>.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load Pipeline datasheet to an R data frame</span></span>
<span><span class="va">myPipelineDataframe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datasheet.html">datasheet</a></span><span class="op">(</span><span class="va">myScenario</span>, name <span class="op">=</span> <span class="st">"core_Pipeline"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check the columns of the Pipeline data frame</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">myPipelineDataframe</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 'data.frame':    0 obs. of  2 variables:</span></span>
<span><span class="co">##  $ StageNameId: Factor w/ 2 levels "Hello World Spatial 1 (R)",..: </span></span>
<span><span class="co">##  $ RunOrder   : num</span></span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create Pipeline data and add it to the Pipeline data frame</span></span>
<span><span class="va">myPipelineRow</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>StageNameId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hello World Spatial 1 (R)"</span>, </span>
<span>                                            <span class="st">"Hello World Spatial 2 (R)"</span><span class="op">)</span>,</span>
<span>                            RunOrder <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">myPipelineDataframe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addRow.html">addRow</a></span><span class="op">(</span><span class="va">myPipelineDataframe</span>, <span class="va">myPipelineRow</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check values</span></span>
<span><span class="va">myPipelineDataframe</span></span></code></pre></div>
<pre><code><span><span class="co">##                 StageNameId RunOrder</span></span>
<span><span class="co">## 1 Hello World Spatial 1 (R)        1</span></span>
<span><span class="co">## 2 Hello World Spatial 2 (R)        2</span></span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Save Pipeline R data frame to a SyncroSim datasheet</span></span>
<span><span class="fu"><a href="../reference/saveDatasheet.html">saveDatasheet</a></span><span class="op">(</span>ssimObject <span class="op">=</span> <span class="va">myScenario</span>, data <span class="op">=</span> <span class="va">myPipelineDataframe</span>,</span>
<span>              name <span class="op">=</span> <span class="st">"core_Pipeline"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Datasheet &lt;core_Pipeline&gt; saved</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="run-scenarios">Run scenarios<a class="anchor" aria-label="anchor" href="#run-scenarios"></a>
</h2>
<div class="section level3">
<h3 id="setting-run-parameters-with-run">Setting run parameters with <code>run()</code><a class="anchor" aria-label="anchor" href="#setting-run-parameters-with-run"></a>
</h3>
<p>We will now run our scenario using the <code><a href="../reference/run.html">run()</a></code> function in
<code>rsyncrosim</code>.</p>
<p>If we have a large model and we want to parallelize the run using
multiprocessing, we can modify the library-scoped “core_Multiprocessing”
datasheet. Since we are using five iterations in our model, we will set
the number of jobs to five so each multiprocessing core will run a
single iteration.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load list of available library-scoped datasheets</span></span>
<span><span class="fu"><a href="../reference/datasheet.html">datasheet</a></span><span class="op">(</span><span class="va">myLibrary</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      scope                      name             displayName</span></span>
<span><span class="co">## 1  library               core_Backup                  Backup</span></span>
<span><span class="co">## 2  library             core_JlConfig                   Julia</span></span>
<span><span class="co">## 3  library      core_Multiprocessing         Multiprocessing</span></span>
<span><span class="co">## 4  library               core_Option                 Options</span></span>
<span><span class="co">## 5  library core_ProcessorGroupOption Processor Group Options</span></span>
<span><span class="co">## 6  library  core_ProcessorGroupValue  Processor Group Values</span></span>
<span><span class="co">## 7  library             core_PyConfig                  Python</span></span>
<span><span class="co">## 8  library              core_RConfig                       R</span></span>
<span><span class="co">## 9  library              core_Setting                Settings</span></span>
<span><span class="co">## 10 library        core_SpatialOption         Spatial Options</span></span>
<span><span class="co">## 11 library            core_SysFolder                 Folders</span></span></code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the library-scoped multiprocessing datasheet</span></span>
<span><span class="va">multiprocess</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datasheet.html">datasheet</a></span><span class="op">(</span><span class="va">myLibrary</span>, name <span class="op">=</span> <span class="st">"core_Multiprocessing"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check required inputs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">multiprocess</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 'data.frame':    1 obs. of  4 variables:</span></span>
<span><span class="co">##  $ EnableMultiprocessing  : logi FALSE</span></span>
<span><span class="co">##  $ MaximumJobs            : num 7</span></span>
<span><span class="co">##  $ EnableMultiScenario    : logi FALSE</span></span>
<span><span class="co">##  $ EnableCopyExternalFiles: logi NA</span></span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Enable multiprocessing</span></span>
<span><span class="va">multiprocess</span><span class="op">$</span><span class="va">EnableMultiprocessing</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span></span>
<span><span class="co"># Set maximum number of jobs to 5</span></span>
<span><span class="va">multiprocess</span><span class="op">$</span><span class="va">MaximumJobs</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span></span>
<span><span class="co"># Save multiprocessing configuration</span></span>
<span><span class="fu"><a href="../reference/saveDatasheet.html">saveDatasheet</a></span><span class="op">(</span>ssimObject <span class="op">=</span> <span class="va">myLibrary</span>, </span>
<span>              data <span class="op">=</span> <span class="va">multiprocess</span>, </span>
<span>              name <span class="op">=</span> <span class="st">"core_Multiprocessing"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Datasheet &lt;core_Multiprocessing&gt; saved</span></span></code></pre>
<p>Now, when we run our scenario, it will use the desired
multiprocessing configuration.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run the first scenario we created</span></span>
<span><span class="va">myResultScenario</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="va">myScenario</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Running scenario [1] My spatial scenario"</span></span></code></pre>
<p>After the scenario has been run, a results scenario is created that
contains results in the output datasheets.</p>
</div>
</div>
<div class="section level2">
<h2 id="view-results">View results<a class="anchor" aria-label="anchor" href="#view-results"></a>
</h2>
<p>The next step is to view the output datasheets added to the result
scenario when it was run.</p>
<div class="section level3">
<h3 id="viewing-non-spatial-results-with-datasheet">Viewing non-spatial results with <code>datasheet()</code><a class="anchor" aria-label="anchor" href="#viewing-non-spatial-results-with-datasheet"></a>
</h3>
<p>First, we will view the non-spatial results within the results
scenarios. For each step in the pipeline, We can load the result tables
using the <code><a href="../reference/datasheet.html">datasheet()</a></code> function.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load results of first transformer in the pipeline</span></span>
<span><span class="va">resultsSummary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datasheet.html">datasheet</a></span><span class="op">(</span><span class="va">myResultScenario</span>,</span>
<span>                            name <span class="op">=</span> <span class="st">"helloworldSpatial_IntermediateDatasheet"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View results table of first transformer in the pipeline</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">resultsSummary</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Iteration Timestep         y        OutputRasterFile</span></span>
<span><span class="co">## 1         1        1  67.68919 rasterMap_iter1_ts1.tif</span></span>
<span><span class="co">## 2         1        2 139.71237 rasterMap_iter1_ts2.tif</span></span>
<span><span class="co">## 3         1        3 211.73555 rasterMap_iter1_ts3.tif</span></span>
<span><span class="co">## 4         1        4 283.75874 rasterMap_iter1_ts4.tif</span></span>
<span><span class="co">## 5         1        5 355.78192 rasterMap_iter1_ts5.tif</span></span>
<span><span class="co">## 6         1        6 427.80510 rasterMap_iter1_ts6.tif</span></span></code></pre>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load results of second transformer in the pipeline</span></span>
<span><span class="va">resultsSummary2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datasheet.html">datasheet</a></span><span class="op">(</span><span class="va">myResultScenario</span>,</span>
<span>                             name <span class="op">=</span> <span class="st">"helloworldSpatial_OutputDatasheet"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View results table of second transformer in the pipeline</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">resultsSummary2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Iteration Timestep       yCum</span></span>
<span><span class="co">## 1         1        1   67.68919</span></span>
<span><span class="co">## 2         1        2  207.40156</span></span>
<span><span class="co">## 3         1        3  419.13711</span></span>
<span><span class="co">## 4         1        4  702.89585</span></span>
<span><span class="co">## 5         1        5 1058.67777</span></span>
<span><span class="co">## 6         1        6 1486.48287</span></span></code></pre>
<p>From viewing these datasheets, we can see that the spatial output is
contained within the <code>IntermediateDatasheet</code>, in the column
called <code>OutputRasterFile</code>.</p>
</div>
<div class="section level3">
<h3 id="viewing-spatial-results-with-datasheetspatraster">Viewing spatial results with <code>datasheetSpatRaster()</code><a class="anchor" aria-label="anchor" href="#viewing-spatial-results-with-datasheetspatraster"></a>
</h3>
<p>For spatial results, we want to load the results as raster images. To
do this, we will use the <code><a href="../reference/datasheetSpatRaster.html">datasheetSpatRaster()</a></code> function
from <code>rsyncrosim</code>. The first argument is the <em>result
scenario</em> object. Next, we specify the name of the datasheet
containing raster images using the <code>datasheet</code> argument, and
the column pertaining to the raster images using the <code>column</code>
argument. The results contain many raster images, since we have a raster
for each combination of iteration and timestep. We can use the
<code>iteration</code> and <code>timestep</code> arguments to specify a
single raster image or a subset of raster images we want to view.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load raster files for first result scenario with timestep and iteration</span></span>
<span><span class="va">rasterMaps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datasheetSpatRaster.html">datasheetSpatRaster</a></span><span class="op">(</span></span>
<span>  <span class="va">myResultScenario</span>,</span>
<span>  datasheet <span class="op">=</span> <span class="st">"helloworldSpatial_IntermediateDatasheet"</span>,</span>
<span>  column <span class="op">=</span> <span class="st">"OutputRasterFile"</span>,</span>
<span>  iteration <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  timestep <span class="op">=</span> <span class="fl">5</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># View results</span></span>
<span><span class="va">rasterMaps</span></span></code></pre></div>
<pre><code><span><span class="co">## class       : SpatRaster </span></span>
<span><span class="co">## dimensions  : 5, 5, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">## resolution  : 0.4, 0.4  (x, y)</span></span>
<span><span class="co">## extent      : -1, 1, -1, 1  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">## coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span><span class="co">## source      : rasterMap_iter1_ts5.tif </span></span>
<span><span class="co">## name        : rasterMap_iter1_ts5 </span></span>
<span><span class="co">## min value   :            11.77882 </span></span>
<span><span class="co">## max value   :            16.52308</span></span></code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rasterMaps</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="a04_rsyncrosim_vignette_spatial_files/figure-html/view%20results%20raster-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="viewing-spatial-results-in-syncrosim-studio">Viewing spatial results in SyncroSim Studio<a class="anchor" aria-label="anchor" href="#viewing-spatial-results-in-syncrosim-studio"></a>
</h3>
<p>To create maps using the results scenario we just generated, open the
current library in SyncroSim Studio and sync the updates from
<code>rsyncrosim</code> using the “refresh” button in the upper toolbar
(circled in red below). All the updates made in <code>rsyncrosim</code>
should appear in SyncroSim Studio. We can now add the results scenario
to the Results Viewer and create our maps. For more information on
generating map in SyncroSim Studio, see the SyncroSim tutorials on
<a href="http://docs.syncrosim.com/how_to_guides/results_map_create.html" target="_blank" class="external-link">creating</a>
and
<a href="http://docs.syncrosim.com/how_to_guides/results_map_customize.html" target="_blank" class="external-link">customizing</a>
maps</p>
<div class="float">
<img src="rsyncrosim-with-UI-spatial.png" width="600" alt="Using rsyncrosim with SyncroSim Studio to map spatial data"><div class="figcaption">Using <code>rsyncrosim</code> with SyncroSim
Studio to map spatial data</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Colin Daniel, Josie Hughes, Valentin Lucet, Alex Embrey, Katie Birchard, Leonardo Frid, Tabitha Kennedy, Shreeram Senthivasan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
