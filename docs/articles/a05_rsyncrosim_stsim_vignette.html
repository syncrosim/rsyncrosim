<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>`rsyncrosim`: introduction to `ST-Sim` • rsyncrosim</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="`rsyncrosim`: introduction to `ST-Sim`">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rsyncrosim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/a01_rsyncrosim_vignette_basic.html">Introduction to `rsyncrosim`</a></li>
    <li><a class="dropdown-item" href="../articles/a02_rsyncrosim_vignette_uncertainty.html">`rsyncrosim`: introduction to uncertainty</a></li>
    <li><a class="dropdown-item" href="../articles/a03_rsyncrosim_vignette_pipelines.html">`rsyncrosim`: introduction to pipelines</a></li>
    <li><a class="dropdown-item" href="../articles/a04_rsyncrosim_vignette_spatial.html">`rsyncrosim`: introduction to spatial data</a></li>
    <li><a class="dropdown-item" href="../articles/a05_rsyncrosim_stsim_vignette.html">`rsyncrosim`: introduction to `ST-Sim`</a></li>
    <li><a class="dropdown-item" href="../articles/a06_rsyncrosim_install_github.html">Installing GitHub release</a></li>
    <li><a class="dropdown-item" href="../articles/using-conda-with-rsyncrosim.html">Conda Demo</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/syncrosim/rsyncrosim/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>`rsyncrosim`: introduction to `ST-Sim`</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/syncrosim/rsyncrosim/blob/HEAD/vignettes/a05_rsyncrosim_stsim_vignette.Rmd" class="external-link"><code>vignettes/a05_rsyncrosim_stsim_vignette.Rmd</code></a></small>
      <div class="d-none name"><code>a05_rsyncrosim_stsim_vignette.Rmd</code></div>
    </div>

    
    
<p>This vignette will cover how to develop and run spatially-explicit,
stochastic state-and-transition simulation models of landscape change
using the <code>rsyncrosim</code> package within the
<a href="https://syncrosim.com/" target="_blank" class="external-link">SyncroSim</a> software
framework. For an overview of
<a href="https://syncrosim.com/" target="_blank" class="external-link">SyncroSim</a> and
<code>rsyncrosim</code>, as well as a basic usage tutorial for
<code>rsyncrosim</code>, see the
<a href="https://syncrosim.github.io/rsyncrosim/articles/a01_rsyncrosim_vignette_basic.html#setup-1" target="_blank">Introduction
to <code>rsyncrosim</code></a> vignette.</p>
<div class="section level2">
<h2 id="syncrosim-package-stsim">SyncroSim Package: <code>stsim</code><a class="anchor" aria-label="anchor" href="#syncrosim-package-stsim"></a>
</h2>
<p>To demonstrate how to create and run spatially-explicit, stochastic
state-and-transition simulation models (STSMs) of landscape change, we
will be using the
<a href="https://github.com/ApexRMS/stsim" target="_blank" class="external-link">stsim</a>
SyncroSim package. STSMs are well-suited for integrating uncertainty
into model projections, and have been applied to a variety of landscapes
and management questions. In this <code>stsim</code> example below, we
will model changes in forest cover types under two scenarios: no harvest
within a landscape, and harvest of 20 acres per year. To do this, we
will set a number of model parameters describing how many timesteps and
iterations the model will run for, transition types and their
probabilities, transition targets (particularly, for the harvest
transition type), etc. Next, we will provide <code>stsim</code> with a
set of initial conditions that describe the starting landscape at time
0, and specify parameters for the model’s output. After running both
scenarios, we will view the output data in tabular form and as a raster
layer. Spatial and non-spatial examples of this exercise are
provided.</p>
<p>For more details on <code>stsim</code>, consult the
<a href="https://docs.stsim.net/" target="_blank" class="external-link">ST-Sim online
documentation</a>.</p>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="section level3">
<h3 id="install-syncrosim">Install SyncroSim<a class="anchor" aria-label="anchor" href="#install-syncrosim"></a>
</h3>
<p>Before using <code>rsyncrosim</code> you will first need to
<a href="https://syncrosim.com/download/" target="_blank" class="external-link">download and
install</a> the SyncroSim software. Versions of SyncroSim exist for both
Windows and Linux.</p>
<p><em>Note</em>: this tutorial was developed using
<code>rsyncrosim</code> version 2.0. To use <code>rsyncrosim</code>
version 2.0 or greater, SyncroSim version 3.0 or greater is
required.</p>
</div>
<div class="section level3">
<h3 id="installing-and-loading-r-packages">Installing and loading R packages<a class="anchor" aria-label="anchor" href="#installing-and-loading-r-packages"></a>
</h3>
<p>You will need to install the <code>rsyncrosim</code> R package,
either using
<a href="https://cran.r-project.org/" target="_blank" class="external-link">CRAN</a> or from
the <code>rsyncrosim</code>
<a href="https://github.com/syncrosim/rsyncrosim/releases/" target="_blank" class="external-link">GitHub
repository</a>. Versions of <code>rsyncrosim</code> are available for
both Windows and Linux. You may need to install the <code>terra</code>
package from CRAN as well.</p>
<p>In a new R script, load the necessary packages. This includes the
<code>rsyncrosim</code> and <code>terra</code> R packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load R packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">rsyncrosim</span><span class="op">)</span>  <span class="co"># package for working with SyncroSim</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span>       <span class="co"># package for working with spatial data</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="connecting-r-to-syncrosim-using-session">Connecting R to SyncroSim using <code>session()</code><a class="anchor" aria-label="anchor" href="#connecting-r-to-syncrosim-using-session"></a>
</h3>
<p>Finish setting up the R environment for the <code>rsyncrosim</code>
workflow by creating a SyncroSim <em>Session</em> object. Use the
<code><a href="../reference/session.html">session()</a></code> function to connect R to your installed copy of
the SyncroSim software.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mySession</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/session.html">session</a></span><span class="op">(</span><span class="st">"path/to/install_folder"</span><span class="op">)</span>      <span class="co"># Create a Session based SyncroSim install folder</span></span>
<span><span class="va">mySession</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/session.html">session</a></span><span class="op">(</span><span class="op">)</span>                              <span class="co"># Using default install folder (Windows only)</span></span>
<span><span class="va">mySession</span>                                           <span class="co"># Displays the Session object</span></span></code></pre></div>
<pre><code><span><span class="co">## class               : Session</span></span>
<span><span class="co">## filepath [character]: C:/Program Files/SyncroSim Studio</span></span>
<span><span class="co">## silent [logical]    : TRUE</span></span>
<span><span class="co">## printCmd [logical]  : FALSE</span></span>
<span><span class="co">## condaFilepath [NULL]:</span></span></code></pre>
<p>Use the <code><a href="../reference/version.html">version()</a></code> function to ensure you are using the
latest version of SyncroSim.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/version.html">version</a></span><span class="op">(</span><span class="va">mySession</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "3.0.9"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="installing-syncrosim-packages-using-installpackage">Installing SyncroSim packages using
<code>installPackage()</code><a class="anchor" aria-label="anchor" href="#installing-syncrosim-packages-using-installpackage"></a>
</h3>
<p>Install <code>stsim</code> using the <code>rsyncrosim</code> function
<code><a href="../reference/installPackage.html">installPackage()</a></code>. This function takes a package name as
input and then queries the SyncroSim package server for the specified
package.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install stsim</span></span>
<span><span class="fu"><a href="../reference/installPackage.html">installPackage</a></span><span class="op">(</span><span class="st">"stsim"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Package &lt;stsim v4.0.1&gt; installed</span></span></code></pre>
<p><code>stsim</code> should now be included in the package list
returned by the <code><a href="../reference/packages.html">packages()</a></code> function in
<code>rsyncrosim</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get list of installed packages</span></span>
<span><span class="fu"><a href="../reference/packages.html">packages</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    name version                                      description</span></span>
<span><span class="co">## 1 stsim   4.0.1 The ST-Sim state-and-transition simulation model</span></span>
<span><span class="co">##                                                                     location</span></span>
<span><span class="co">## 1 C:\\Users\\birch\\AppData\\Local\\SyncroSim Studio\\Packages\\stsim\\4.0.1</span></span>
<span><span class="co">##   status</span></span>
<span><span class="co">## 1     OK</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="create-a-modeling-workflow">Create a modeling workflow<a class="anchor" aria-label="anchor" href="#create-a-modeling-workflow"></a>
</h2>
<p>When creating a new modeling workflow from scratch, we need to create
objects of the following scopes:</p>
<ul>
<li><a href="https://docs.syncrosim.com/how_to_guides/library_overview.html" target="_blank" class="external-link">Library</a></li>
<li><a href="https://docs.syncrosim.com/how_to_guides/library_overview.html" target="_blank" class="external-link">Projects</a></li>
<li><a href="https://docs.syncrosim.com/how_to_guides/library_overview.html" target="_blank" class="external-link">Scenarios</a></li>
</ul>
<p>For more information on these scopes, see the</p>
<p><a href="https://syncrosim.github.io/rsyncrosim/articles/a01_rsyncrosim_vignette_basic.html" target="_blank">Introduction
to <code>rsyncrosim</code></a> vignette.</p>
<div class="section level3">
<h3 id="set-up-library-project-and-scenario">Set up library, project, and scenario<a class="anchor" aria-label="anchor" href="#set-up-library-project-and-scenario"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a new library</span></span>
<span><span class="va">myLibrary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ssimLibrary.html">ssimLibrary</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"stsimLibrary.ssim"</span>,</span>
<span>                         session <span class="op">=</span> <span class="va">mySession</span>,</span>
<span>                         packages <span class="op">=</span> <span class="st">"stsim"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Package &lt;stsim v4.0.1&gt; added</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>                         <span class="co"># overwrite = TRUE)</span></span>
<span></span>
<span><span class="co"># Open the default project</span></span>
<span><span class="va">myProject</span> <span class="op">&lt;-</span> <span class="fu">rsyncrosim</span><span class="fu">::</span><span class="fu"><a href="../reference/project.html">project</a></span><span class="op">(</span>ssimObject <span class="op">=</span> <span class="va">myLibrary</span>, project <span class="op">=</span> <span class="st">"Definitions"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a new scenario (associated with the default project)</span></span>
<span><span class="va">myScenario</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scenario.html">scenario</a></span><span class="op">(</span>ssimObject <span class="op">=</span> <span class="va">myProject</span>, scenario <span class="op">=</span> <span class="st">"My spatial scenario"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="view-model-inputs-using-datasheet">View model inputs using <code>datasheet()</code><a class="anchor" aria-label="anchor" href="#view-model-inputs-using-datasheet"></a>
</h3>
<p>View the datasheets associated with your new project and scenario
using the <code><a href="../reference/datasheet.html">datasheet()</a></code> function from
<code>rsyncrosim</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># View all datasheets associated with a library, project, or scenario</span></span>
<span><span class="va">datasheet_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datasheet.html">datasheet</a></span><span class="op">(</span><span class="va">myScenario</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">datasheet_list</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       scope                          name             displayName</span></span>
<span><span class="co">## 49 scenario        core_DistributionValue           Distributions</span></span>
<span><span class="co">## 50 scenario    core_ExternalVariableValue      External Variables</span></span>
<span><span class="co">## 51 scenario                 core_Pipeline                Pipeline</span></span>
<span><span class="co">## 52 scenario   core_SpatialMultiprocessing Spatial Multiprocessing</span></span>
<span><span class="co">## 53 scenario stsim_DeterministicTransition                  States</span></span>
<span><span class="co">## 54 scenario   stsim_DigitalElevationModel Digital Elevation Model</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">datasheet_list</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        scope                                        name</span></span>
<span><span class="co">## 133 scenario             stsim_TransitionSlopeMultiplier</span></span>
<span><span class="co">## 134 scenario stsim_TransitionSpatialInitiationMultiplier</span></span>
<span><span class="co">## 135 scenario           stsim_TransitionSpatialMultiplier</span></span>
<span><span class="co">## 136 scenario          stsim_TransitionSpreadDistribution</span></span>
<span><span class="co">## 137 scenario                      stsim_TransitionTarget</span></span>
<span><span class="co">## 138 scenario        stsim_TransitionTargetPrioritization</span></span>
<span><span class="co">##                                   displayName</span></span>
<span><span class="co">## 133              Transition Slope Multipliers</span></span>
<span><span class="co">## 134 Transition Spatial Initiation Multipliers</span></span>
<span><span class="co">## 135            Transition Spatial Multipliers</span></span>
<span><span class="co">## 136            Transition Spread Distribution</span></span>
<span><span class="co">## 137                        Transition Targets</span></span>
<span><span class="co">## 138          Transition Target Prioritization</span></span></code></pre>
<p>From this list of datasheets, we can check which datasheets specific
to the <code>stsim</code> package we would like to modify. This will
include a number of Initial Conditions datasheets, Output datasheets,
and a Run Control datasheet. For more information about all
<code>stsim</code> datasheets, see
<a href="https://docs.stsim.net/reference/properties.html" target="_blank" class="external-link">the
online documentation</a>.</p>
</div>
<div class="section level3">
<h3 id="configure-model-inputs-using-datasheet-and-addrow">Configure model inputs using <code>datasheet()</code> and
<code>addRow()</code><a class="anchor" aria-label="anchor" href="#configure-model-inputs-using-datasheet-and-addrow"></a>
</h3>
<p>Now, we will add some values to these datasheets so we can run our
models.</p>
<p>Inputs for <code>stsim</code> come in two forms: scenario inputs
(which <em>can</em> vary by scenario) and project inputs (which
<em>must</em> be fixed across all scenarios). In general most inputs are
scenario inputs; project inputs are typically reserved for values that
must be shared by all scenarios (e.g. constants, shared lookup values).
We refer to project input datasheets as <em>project-scoped
datasheets</em> and scenario input datasheets as <em>scenario-scoped
datasheets</em>. We will start by retrieving some project-scoped input
datasheets to add and edit their values.</p>
<div class="section level4">
<h4 id="project-scoped-datasheets">Project-scoped datasheets<a class="anchor" aria-label="anchor" href="#project-scoped-datasheets"></a>
</h4>
<p><strong>Terminology</strong>: The project-scoped datasheet called
<code>Terminology</code> specifies terms used across all scenarios in
the same project.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the Terminology datasheet to a new R data frame </span></span>
<span><span class="va">terminology</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datasheet.html">datasheet</a></span><span class="op">(</span><span class="va">myProject</span>, name <span class="op">=</span> <span class="st">"stsim_Terminology"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check the columns of the Terminology data frame</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">terminology</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 'data.frame':    1 obs. of  9 variables:</span></span>
<span><span class="co">##  $ AmountLabel          : chr "Area"</span></span>
<span><span class="co">##  $ AmountUnits          : Factor w/ 5 levels "acres","hectares",..: 1</span></span>
<span><span class="co">##  $ StateLabelX          : chr "Class"</span></span>
<span><span class="co">##  $ StateLabelY          : chr "Subclass"</span></span>
<span><span class="co">##  $ PrimaryStratumLabel  : chr "Primary Stratum"</span></span>
<span><span class="co">##  $ SecondaryStratumLabel: chr "Secondary Stratum"</span></span>
<span><span class="co">##  $ TertiaryStratumLabel : chr "Tertiary Stratum"</span></span>
<span><span class="co">##  $ TimestepUnits        : chr "Timestep"</span></span>
<span><span class="co">##  $ StockUnits           : chr "Tons"</span></span></code></pre>
<p>We can change the terminology of the <code>StateLabelX</code> and
<code>AmountUnits</code> columns in this datasheet, and then save those
changes back to the SyncroSim library file.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Edit the values of the StateLabelX and AmountUnits columns</span></span>
<span><span class="va">terminology</span><span class="op">$</span><span class="va">AmountUnits</span> <span class="op">&lt;-</span> <span class="st">"hectares"</span></span>
<span><span class="va">terminology</span><span class="op">$</span><span class="va">StateLabelX</span> <span class="op">&lt;-</span> <span class="st">"Forest Type"</span></span>
<span></span>
<span><span class="co"># Saves edits as a SyncroSim datasheet</span></span>
<span><span class="fu"><a href="../reference/saveDatasheet.html">saveDatasheet</a></span><span class="op">(</span>ssimObject <span class="op">=</span> <span class="va">myProject</span>, </span>
<span>              data <span class="op">=</span> <span class="va">terminology</span>, </span>
<span>              name <span class="op">=</span> <span class="st">"stsim_Terminology"</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## Datasheet &lt;stsim_Terminology&gt; saved</span></span></code></pre>
<p>Similarly, we can edit other project-scoped datasheets for
‘stsim’.</p>
<p><strong>Stratum</strong>: Primary Strata in the model</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load a copy of the Stratum datasheet.</span></span>
<span><span class="co"># To load an empty copy of this datasheet, specify the argument empty = TRUE</span></span>
<span><span class="va">stratum</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datasheet.html">datasheet</a></span><span class="op">(</span><span class="va">myProject</span>, <span class="st">"stsim_Stratum"</span>, empty <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use the addRow() to add a value to the stratum  data frame</span></span>
<span><span class="va">stratum</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addRow.html">addRow</a></span><span class="op">(</span><span class="va">stratum</span>, <span class="st">"Entire Forest"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save edits as a SyncroSim datasheet</span></span>
<span><span class="fu"><a href="../reference/saveDatasheet.html">saveDatasheet</a></span><span class="op">(</span><span class="va">myProject</span>, <span class="va">stratum</span>, <span class="st">"stsim_Stratum"</span>, force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Datasheet &lt;stsim_Stratum&gt; saved</span></span></code></pre>
<p><strong>StateLabelX</strong>: First dimension of labels for State
Classes</p>
<p>It is also possible to add values to a datasheet without loading it
into R. Below we create a vector of <code>forestTypes</code> and add
this to the <code>stsim_StateLabelX</code> datasheet as a data frame
using <code><a href="../reference/saveDatasheet.html">saveDatasheet()</a></code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a vector containing the State Class labels </span></span>
<span><span class="va">forestTypes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Coniferous"</span>, <span class="st">"Deciduous"</span>, <span class="st">"Mixed"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add values as a data frame to a SyncroSim datasheet</span></span>
<span><span class="fu"><a href="../reference/saveDatasheet.html">saveDatasheet</a></span><span class="op">(</span><span class="va">myProject</span>, </span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Name <span class="op">=</span> <span class="va">forestTypes</span><span class="op">)</span>, </span>
<span>              <span class="st">"stsim_StateLabelX"</span>, </span>
<span>              force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Datasheet &lt;stsim_StateLabelX&gt; saved</span></span></code></pre>
<p><strong>StateLabelY</strong>: Second dimension of labels for State
Classes</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add values as a data frame directly to an stsim datasheet</span></span>
<span><span class="fu"><a href="../reference/saveDatasheet.html">saveDatasheet</a></span><span class="op">(</span><span class="va">myProject</span>, </span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"All"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>              <span class="st">"stsim_StateLabelY"</span>, </span>
<span>              force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Datasheet &lt;stsim_StateLabelY&gt; saved</span></span></code></pre>
<p><strong>State Classes</strong>: Combine <code>StateLabelX</code> and
<code>StateLabelY</code>, and assign each class a unique name and Id</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a new R data frame containing the names of the State Classes </span></span>
<span><span class="co"># and their corresponding data</span></span>
<span><span class="va">stateClasses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Name <span class="op">=</span> <span class="va">forestTypes</span><span class="op">)</span></span>
<span><span class="va">stateClasses</span><span class="op">$</span><span class="va">StateLabelXId</span> <span class="op">&lt;-</span> <span class="va">stateClasses</span><span class="op">$</span><span class="va">Name</span></span>
<span><span class="va">stateClasses</span><span class="op">$</span><span class="va">StateLabelYId</span> <span class="op">&lt;-</span> <span class="st">"All"</span></span>
<span><span class="va">stateClasses</span><span class="op">$</span><span class="va">Id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save stateClasses R data frame to a SyncroSim datasheet</span></span>
<span><span class="fu"><a href="../reference/saveDatasheet.html">saveDatasheet</a></span><span class="op">(</span><span class="va">myProject</span>, <span class="va">stateClasses</span>, <span class="st">"stsim_StateClass"</span>, force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Datasheet &lt;stsim_StateClass&gt; saved</span></span></code></pre>
<p><strong>Transition Types</strong>: Assign a unique name and Id to
each type of transition in our model.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create an R data frame containing transition type data </span></span>
<span><span class="va">transitionTypes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Fire"</span>, <span class="st">"Harvest"</span>, <span class="st">"Succession"</span><span class="op">)</span>, </span>
<span>                              Id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save transitionTypes R data frame to a SyncroSim datasheet</span></span>
<span><span class="fu"><a href="../reference/saveDatasheet.html">saveDatasheet</a></span><span class="op">(</span><span class="va">myProject</span>, <span class="va">transitionTypes</span>, <span class="st">"stsim_TransitionType"</span>, force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Datasheet &lt;stsim_TransitionType&gt; saved</span></span></code></pre>
<p><strong>Transition Groups</strong>: Create Transition Groups
identical to the Types</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create an R data frame containing a column of transition type names </span></span>
<span><span class="va">transitionGroups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Fire"</span>, <span class="st">"Harvest"</span>, <span class="st">"Succession"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save transitionGroups R data frame to a SyncroSim datasheet</span></span>
<span><span class="fu"><a href="../reference/saveDatasheet.html">saveDatasheet</a></span><span class="op">(</span><span class="va">myProject</span>, <span class="va">transitionGroups</span>, <span class="st">"stsim_TransitionGroup"</span>, force <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Datasheet &lt;stsim_TransitionGroup&gt; saved</span></span></code></pre>
<p><strong>Transition Types by Groups</strong>: Assign each Type to its
Group</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create an R data frame that contains Transition Type Group names</span></span>
<span><span class="va">transitionTypesGroups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>TransitionTypeId <span class="op">=</span> <span class="va">transitionTypes</span><span class="op">$</span><span class="va">Name</span>,</span>
<span>                                    TransitionGroupId <span class="op">=</span> <span class="va">transitionGroups</span><span class="op">$</span><span class="va">Name</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save transitionTypesGroups R data frame to a SyncroSim datasheet</span></span>
<span><span class="fu"><a href="../reference/saveDatasheet.html">saveDatasheet</a></span><span class="op">(</span><span class="va">myProject</span>, </span>
<span>              <span class="va">transitionTypesGroups</span>, </span>
<span>              <span class="st">"stsim_TransitionTypeGroup"</span>, </span>
<span>              force <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Datasheet &lt;stsim_TransitionTypeGroup&gt; saved</span></span></code></pre>
<p><strong>Ages</strong>: Define the basic parameters to control the age
reporting in the model</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define values for age reporting</span></span>
<span><span class="va">ageFrequency</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">ageMax</span> <span class="op">&lt;-</span> <span class="fl">101</span></span>
<span><span class="va">ageGroups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">60</span>, <span class="fl">80</span>, <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add values as R data frames to the appropriate SyncroSim datasheet</span></span>
<span><span class="fu"><a href="../reference/saveDatasheet.html">saveDatasheet</a></span><span class="op">(</span><span class="va">myProject</span>, </span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Frequency <span class="op">=</span> <span class="va">ageFrequency</span>, MaximumAge <span class="op">=</span> <span class="va">ageMax</span><span class="op">)</span>,</span>
<span>              <span class="st">"stsim_AgeType"</span>, </span>
<span>              force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Datasheet &lt;stsim_AgeType&gt; saved</span></span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/saveDatasheet.html">saveDatasheet</a></span><span class="op">(</span><span class="va">myProject</span>, </span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>MaximumAge <span class="op">=</span> <span class="va">ageGroups</span><span class="op">)</span>, </span>
<span>              <span class="st">"stsim_AgeGroup"</span>, </span>
<span>              force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Datasheet &lt;stsim_AgeGroup&gt; saved</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="scenario-scoped-datasheets">Scenario-scoped datasheets<a class="anchor" aria-label="anchor" href="#scenario-scoped-datasheets"></a>
</h4>
<p>Now that we have defined all our project-scoped input datasheets, we
can move on to specifying scenario-specific model inputs. We begin by
using the <code>scenario</code> function to create a new scenario in our
project.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a new SyncroSim scenario</span></span>
<span><span class="va">myScenario</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scenario.html">scenario</a></span><span class="op">(</span><span class="va">myProject</span>, <span class="st">"No Harvest"</span><span class="op">)</span></span></code></pre></div>
<p>Once again we can use the <code><a href="../reference/datasheet.html">datasheet()</a></code> function (with
<code>summary=TRUE</code>) to display all the scenario-scoped
datasheets.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Subset the full datasheet list to show only scenario-scoped datasheets</span></span>
<span><span class="va">scenario_datasheet_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="fu"><a href="../reference/datasheet.html">datasheet</a></span><span class="op">(</span><span class="va">myScenario</span>, summary <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                                  <span class="va">scope</span> <span class="op">==</span> <span class="st">"scenario"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scenario_datasheet_list</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       scope                          name             displayName</span></span>
<span><span class="co">## 49 scenario        core_DistributionValue           Distributions</span></span>
<span><span class="co">## 50 scenario    core_ExternalVariableValue      External Variables</span></span>
<span><span class="co">## 51 scenario                 core_Pipeline                Pipeline</span></span>
<span><span class="co">## 52 scenario   core_SpatialMultiprocessing Spatial Multiprocessing</span></span>
<span><span class="co">## 53 scenario stsim_DeterministicTransition                  States</span></span>
<span><span class="co">## 54 scenario   stsim_DigitalElevationModel Digital Elevation Model</span></span></code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">scenario_datasheet_list</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        scope                                        name</span></span>
<span><span class="co">## 133 scenario             stsim_TransitionSlopeMultiplier</span></span>
<span><span class="co">## 134 scenario stsim_TransitionSpatialInitiationMultiplier</span></span>
<span><span class="co">## 135 scenario           stsim_TransitionSpatialMultiplier</span></span>
<span><span class="co">## 136 scenario          stsim_TransitionSpreadDistribution</span></span>
<span><span class="co">## 137 scenario                      stsim_TransitionTarget</span></span>
<span><span class="co">## 138 scenario        stsim_TransitionTargetPrioritization</span></span>
<span><span class="co">##                                   displayName</span></span>
<span><span class="co">## 133              Transition Slope Multipliers</span></span>
<span><span class="co">## 134 Transition Spatial Initiation Multipliers</span></span>
<span><span class="co">## 135            Transition Spatial Multipliers</span></span>
<span><span class="co">## 136            Transition Spread Distribution</span></span>
<span><span class="co">## 137                        Transition Targets</span></span>
<span><span class="co">## 138          Transition Target Prioritization</span></span></code></pre>
<p>We can now use the <code><a href="../reference/datasheet.html">datasheet()</a></code> function to retrieve, one
at a time, each of our scenario-scoped datasheets from our library.</p>
<p><strong>Run Control</strong>: Define the length of the run and
whether or not it is a spatial run (requires spatial inputs to be set,
see below). Here we make the run spatial.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create an R data frame specifying to run the simulation for </span></span>
<span><span class="co"># 7 realizations and 10 timesteps</span></span>
<span><span class="va">runControl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>MaximumIteration <span class="op">=</span> <span class="fl">7</span>,</span>
<span>                         MinimumTimestep <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                         MaximumTimestep <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                         IsSpatial <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save transitionTypesGroups R data frame to a SyncroSim datasheet</span></span>
<span><span class="fu"><a href="../reference/saveDatasheet.html">saveDatasheet</a></span><span class="op">(</span><span class="va">myScenario</span>, <span class="va">runControl</span>, <span class="st">"stsim_RunControl"</span>,append <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Datasheet &lt;stsim_RunControl&gt; saved</span></span></code></pre>
<p><strong>Deterministic Transitions</strong>: Define transitions that
take place in the absence of probabilistic transitions. Here we also set
the age boundaries for each State Class.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load  an empty Deterministic Transitions datasheet to a new R data frame</span></span>
<span><span class="va">dTransitions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datasheet.html">datasheet</a></span><span class="op">(</span><span class="va">myScenario</span>, </span>
<span>                          <span class="st">"stsim_DeterministicTransition"</span>, </span>
<span>                          optional <span class="op">=</span> <span class="cn">T</span>, </span>
<span>                          empty <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                          lookupsAsFactors <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add all Deterministic Transitions to the R data frame</span></span>
<span><span class="va">dTransitions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addRow.html">addRow</a></span><span class="op">(</span><span class="va">dTransitions</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  StateClassIdSource <span class="op">=</span> <span class="st">"Coniferous"</span>,</span>
<span>  StateClassIdDest <span class="op">=</span> <span class="st">"Coniferous"</span>,</span>
<span>  AgeMin <span class="op">=</span> <span class="fl">21</span>,</span>
<span>  Location <span class="op">=</span> <span class="st">"C1"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dTransitions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addRow.html">addRow</a></span><span class="op">(</span><span class="va">dTransitions</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  StateClassIdSource <span class="op">=</span> <span class="st">"Deciduous"</span>,</span>
<span>  StateClassIdDest <span class="op">=</span> <span class="st">"Deciduous"</span>,</span>
<span>  Location <span class="op">=</span> <span class="st">"A1"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dTransitions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addRow.html">addRow</a></span><span class="op">(</span><span class="va">dTransitions</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  StateClassIdSource <span class="op">=</span> <span class="st">"Mixed"</span>,</span>
<span>  StateClassIdDest <span class="op">=</span> <span class="st">"Mixed"</span>,</span>
<span>  AgeMin <span class="op">=</span> <span class="fl">11</span>,</span>
<span>  Location <span class="op">=</span> <span class="st">"B1"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save dTransitions R data frame to a SyncroSim datasheet</span></span>
<span><span class="fu"><a href="../reference/saveDatasheet.html">saveDatasheet</a></span><span class="op">(</span><span class="va">myScenario</span>, <span class="va">dTransitions</span>, <span class="st">"stsim_DeterministicTransition"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Datasheet &lt;stsim_DeterministicTransition&gt; saved</span></span></code></pre>
<p><strong>Probabilistic Transitions</strong>: Define transitions
between State Classes and assigns a probability to each.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load  an empty Probabilistic Transitions datasheet to a new R data frame</span></span>
<span><span class="va">pTransitions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datasheet.html">datasheet</a></span><span class="op">(</span><span class="va">myScenario</span>, </span>
<span>                          <span class="st">"stsim_Transition"</span>, </span>
<span>                          optional <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                          empty <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                          lookupsAsFactors <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add all Probabilistic Transitions to the R data frame</span></span>
<span><span class="va">pTransitions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addRow.html">addRow</a></span><span class="op">(</span><span class="va">pTransitions</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  StateClassIdSource <span class="op">=</span> <span class="st">"Coniferous"</span>, </span>
<span>  StateClassIdDest <span class="op">=</span> <span class="st">"Deciduous"</span>, </span>
<span>  TransitionTypeId <span class="op">=</span> <span class="st">"Fire"</span>, </span>
<span>  Probability <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pTransitions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addRow.html">addRow</a></span><span class="op">(</span><span class="va">pTransitions</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  StateClassIdSource <span class="op">=</span> <span class="st">"Coniferous"</span>,</span>
<span>  StateClassIdDest <span class="op">=</span> <span class="st">"Deciduous"</span>, </span>
<span>  TransitionTypeId <span class="op">=</span> <span class="st">"Harvest"</span>, </span>
<span>  Probability <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  AgeMin <span class="op">=</span> <span class="fl">40</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pTransitions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addRow.html">addRow</a></span><span class="op">(</span><span class="va">pTransitions</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  StateClassIdSource <span class="op">=</span> <span class="st">"Deciduous"</span>,</span>
<span>  StateClassIdDest <span class="op">=</span> <span class="st">"Deciduous"</span>, </span>
<span>  TransitionTypeId <span class="op">=</span> <span class="st">"Fire"</span>, </span>
<span>  Probability <span class="op">=</span> <span class="fl">0.002</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pTransitions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addRow.html">addRow</a></span><span class="op">(</span><span class="va">pTransitions</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  StateClassIdSource <span class="op">=</span> <span class="st">"Deciduous"</span>,</span>
<span>  StateClassIdDest <span class="op">=</span> <span class="st">"Mixed"</span>, </span>
<span>  TransitionTypeId <span class="op">=</span> <span class="st">"Succession"</span>, </span>
<span>  Probability <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>  AgeMin <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pTransitions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addRow.html">addRow</a></span><span class="op">(</span><span class="va">pTransitions</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  StateClassIdSource <span class="op">=</span> <span class="st">"Mixed"</span>, </span>
<span>  StateClassIdDest <span class="op">=</span> <span class="st">"Deciduous"</span>, </span>
<span>  TransitionTypeId <span class="op">=</span> <span class="st">"Fire"</span>, </span>
<span>  Probability <span class="op">=</span> <span class="fl">0.005</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pTransitions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addRow.html">addRow</a></span><span class="op">(</span><span class="va">pTransitions</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  StateClassIdSource <span class="op">=</span> <span class="st">"Mixed"</span>, </span>
<span>  StateClassIdDest <span class="op">=</span> <span class="st">"Coniferous"</span>,</span>
<span>  TransitionTypeId <span class="op">=</span> <span class="st">"Succession"</span>, </span>
<span>  Probability <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>  AgeMin <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save pTransitions R data frame to a SyncroSim datasheet</span></span>
<span><span class="fu"><a href="../reference/saveDatasheet.html">saveDatasheet</a></span><span class="op">(</span><span class="va">myScenario</span>, <span class="va">pTransitions</span>, <span class="st">"stsim_Transition"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Datasheet &lt;stsim_Transition&gt; saved</span></span></code></pre>
<p><strong>Initial Conditions</strong>: Set the starting conditions of
the model at time 0. There are two options for setting initial
conditions: either spatial or non-spatial. In this example we will use
spatial initial conditions; however, we also demonstrate how to set
initial conditions non-spatially below.</p>
<ul>
<li>
<strong><em>Option 1 - Spatial</em></strong>. Let’s first take a
look at our rasters. We will retrieve the sample raster files (in
GeoTIFF format) provided with the <code>rsyncrosim</code> package.</li>
</ul>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load sample .tif files</span></span>
<span><span class="va">stratumTif</span> <span class="op">&lt;-</span> <span class="st">"initial-stratum.tif"</span></span>
<span><span class="va">sclassTif</span> <span class="op">&lt;-</span> <span class="st">"initial-sclass.tif"</span></span>
<span><span class="va">ageTif</span> <span class="op">&lt;-</span> <span class="st">"initial-age.tif"</span></span></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create raster layers from the .tif files</span></span>
<span><span class="va">rStratum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">stratumTif</span><span class="op">)</span></span>
<span><span class="va">rSclass</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">sclassTif</span><span class="op">)</span></span>
<span><span class="va">rAge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">ageTif</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot raster layers</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rStratum</span><span class="op">)</span></span></code></pre></div>
<p><img src="a05_rsyncrosim_stsim_vignette_files/figure-html/plot%20initial%20conditions%20rasters-1.png" width="480" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rSclass</span><span class="op">)</span></span></code></pre></div>
<p><img src="a05_rsyncrosim_stsim_vignette_files/figure-html/plot%20initial%20conditions%20rasters-2.png" width="480" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rAge</span><span class="op">)</span></span></code></pre></div>
<p><img src="a05_rsyncrosim_stsim_vignette_files/figure-html/plot%20initial%20conditions%20rasters-3.png" width="480" style="display: block; margin: auto;"></p>
<p>We can add these rasters as model inputs using the
<code>stsim_InitialConditionsSpatial</code> datasheet.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create an R list of the input raster layers</span></span>
<span><span class="va">ICSpatial</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>StratumFileName <span class="op">=</span> <span class="va">stratumTif</span>, </span>
<span>                  StateClassFileName <span class="op">=</span> <span class="va">sclassTif</span>, </span>
<span>                  AgeFileName <span class="op">=</span> <span class="va">ageTif</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save initialConditionsSpatial R list to a SyncroSim datasheet</span></span>
<span><span class="fu"><a href="../reference/saveDatasheet.html">saveDatasheet</a></span><span class="op">(</span><span class="va">myScenario</span>, <span class="va">ICSpatial</span>, <span class="st">"stsim_InitialConditionsSpatial"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Datasheet &lt;stsim_InitialConditionsSpatial&gt; saved</span></span></code></pre>
<ul>
<li>
<strong><em>Option 2 - Non-spatial</em></strong>. The second option
is to set the proportions of each class, making this a non-spatial
parameterization. To do so, we use the
<code>stsim_InitialConditionsNonSpatial</code> and
<code>stsim_InitialConditionsNonSpatialDistribution</code>
datasheets:</li>
</ul>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create non-spatial initial conditions data and add it to an R data frame</span></span>
<span><span class="va">ICNonSpatial</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>TotalAmount <span class="op">=</span> <span class="fl">100</span>, </span>
<span>                           NumCells <span class="op">=</span> <span class="fl">100</span>, </span>
<span>                           CalcFromDist <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save the ICNonSpatial R data frame to a SyncroSim datasheet</span></span>
<span><span class="fu"><a href="../reference/saveDatasheet.html">saveDatasheet</a></span><span class="op">(</span><span class="va">myScenario</span>, <span class="va">ICNonSpatial</span>, <span class="st">"stsim_InitialConditionsNonSpatial"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Datasheet &lt;stsim_InitialConditionsNonSpatial&gt; saved</span></span></code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create non-spatial initial conditions distribution data and add it to an R data frame</span></span>
<span><span class="va">ICNonSpatialDistribution</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>StratumId <span class="op">=</span> <span class="st">"Entire Forest"</span>, </span>
<span>                                       StateClassId <span class="op">=</span> <span class="st">"Coniferous"</span>, </span>
<span>                                       RelativeAmount <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save the ICNonSpatial R data frame to a SyncroSim datasheet</span></span>
<span><span class="fu"><a href="../reference/saveDatasheet.html">saveDatasheet</a></span><span class="op">(</span><span class="va">myScenario</span>, <span class="va">ICNonSpatialDistribution</span>,</span>
<span>              <span class="st">"stsim_InitialConditionsNonSpatialDistribution"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Datasheet &lt;stsim_InitialConditionsNonSpatialDistribution&gt; saved</span></span></code></pre>
<p><strong>Transition Targets</strong>: Define targets, in units of
area, to be reached by the allocation procedure within SyncroSim.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set the transition target for harvest to 0</span></span>
<span><span class="fu"><a href="../reference/saveDatasheet.html">saveDatasheet</a></span><span class="op">(</span><span class="va">myScenario</span>, </span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>TransitionGroupId <span class="op">=</span> <span class="st">"Harvest"</span>, </span>
<span>                         Amount <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>              <span class="st">"stsim_TransitionTarget"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Datasheet &lt;stsim_TransitionTarget&gt; saved</span></span></code></pre>
<p><strong>Output Options</strong>: Regulate the model outputs and
determine the frequency at which syncrosim saves the model outputs.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create output options for spatial model and add it to an R data frame</span></span>
<span><span class="va">outputOptionsSpatial</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  RasterOutputSC <span class="op">=</span> <span class="cn">T</span>, RasterOutputSCTimesteps <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  RasterOutputTR <span class="op">=</span> <span class="cn">T</span>, RasterOutputTRTimesteps <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  RasterOutputAge <span class="op">=</span> <span class="cn">T</span>, RasterOutputAgeTimesteps <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save the outputOptionsSpatial R data frame to a SyncroSim datasheet</span></span>
<span><span class="fu"><a href="../reference/saveDatasheet.html">saveDatasheet</a></span><span class="op">(</span><span class="va">myScenario</span>, <span class="va">outputOptionsSpatial</span>, <span class="st">"stsim_OutputOptionsSpatial"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Datasheet &lt;stsim_OutputOptionsSpatial&gt; saved</span></span></code></pre>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create output options for non-spatial model and add it to an R data frame</span></span>
<span><span class="va">outputOptionsNonSpatial</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  SummaryOutputSC <span class="op">=</span> <span class="cn">T</span>, SummaryOutputSCTimesteps <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  SummaryOutputTR <span class="op">=</span> <span class="cn">T</span>, SummaryOutputTRTimesteps <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save the outputOptionsNonSpatial R data frame to a SyncroSim datasheet</span></span>
<span><span class="fu"><a href="../reference/saveDatasheet.html">saveDatasheet</a></span><span class="op">(</span><span class="va">myScenario</span>, <span class="va">outputOptionsNonSpatial</span>, <span class="st">"stsim_OutputOptions"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Datasheet &lt;stsim_OutputOptions&gt; saved</span></span></code></pre>
<p><strong>Pipeline datasheet</strong>: Specify which transformer stage
the scenarios will run and in which order.</p>
<p>To learn more about pipelines, see the <a href="https://syncrosim.github.io/rsyncrosim/rsyncrosim_vignette_pipelines.html"><code>rsyncrosim</code>:
introduction to pipelines</a> vignette and the SyncroSim
<a href="https://docs.syncrosim.com/how_to_guides/package_create_pipelines.html" target="_blank" class="external-link">Enhancing
a Package: Linking Models</a> tutorial.</p>
<p>To implement pipelines in our package, we need to specify the order
in which to run the transformers (i.e. models) in our pipeline by
editing the <code>Pipeline</code> datasheet. The <code>Pipeline</code>
datasheet is part of the built-in SyncroSim core, so we access it using
the “core_” prefix with the <code><a href="../reference/datasheet.html">datasheet()</a></code> function.</p>
<p>From viewing the structure of the <code>Pipeline</code> datasheet we
know that the <code>StageNameId</code> is a factor with a single level:
<code>ST-Sim</code>.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load Pipeline datasheet to an R data frame</span></span>
<span><span class="va">myPipelineDataframe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datasheet.html">datasheet</a></span><span class="op">(</span><span class="va">myScenario</span>, name <span class="op">=</span> <span class="st">"core_Pipeline"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check the columns of the Pipeline data frame</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">myPipelineDataframe</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 'data.frame':    0 obs. of  2 variables:</span></span>
<span><span class="co">##  $ StageNameId: Factor w/ 1 level "ST-Sim": </span></span>
<span><span class="co">##  $ RunOrder   : num</span></span></code></pre>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create Pipeline data and add it to the Pipeline data frame</span></span>
<span><span class="va">myPipelineRow</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>StageNameId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ST-Sim"</span><span class="op">)</span>,</span>
<span>                            RunOrder <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">myPipelineDataframe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addRow.html">addRow</a></span><span class="op">(</span><span class="va">myPipelineDataframe</span>, <span class="va">myPipelineRow</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check values</span></span>
<span><span class="va">myPipelineDataframe</span></span></code></pre></div>
<pre><code><span><span class="co">##   StageNameId RunOrder</span></span>
<span><span class="co">## 1      ST-Sim        1</span></span></code></pre>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Save Pipeline R data frame to a SyncroSim datasheet</span></span>
<span><span class="fu"><a href="../reference/saveDatasheet.html">saveDatasheet</a></span><span class="op">(</span>ssimObject <span class="op">=</span> <span class="va">myScenario</span>, </span>
<span>              data <span class="op">=</span> <span class="va">myPipelineDataframe</span>,</span>
<span>              name <span class="op">=</span> <span class="st">"core_Pipeline"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Datasheet &lt;core_Pipeline&gt; saved</span></span></code></pre>
<p>We are done parameterizing our simple “No Harvest” scenario. Let’s
now define a new scenario that implements forest harvesting. Below, we
create a second “Harvest” scenario that is a copy of the first scenario,
but with a harvest level of 20 acres/year.</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a copy of the no harvest scenario (i.e myScenario) and name it myScenarioHarvest</span></span>
<span><span class="va">myScenarioHarvest</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scenario.html">scenario</a></span><span class="op">(</span><span class="va">myProject</span>, </span>
<span>                              scenario <span class="op">=</span> <span class="st">"Harvest"</span>, </span>
<span>                              sourceScenario <span class="op">=</span> <span class="va">myScenario</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set the transition target for harvest to 20 acres/year</span></span>
<span><span class="fu"><a href="../reference/saveDatasheet.html">saveDatasheet</a></span><span class="op">(</span><span class="va">myScenarioHarvest</span>, </span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>TransitionGroupId <span class="op">=</span> <span class="st">"Harvest"</span>, Amount <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>, </span>
<span>              <span class="st">"stsim_TransitionTarget"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Datasheet &lt;stsim_TransitionTarget&gt; saved</span></span></code></pre>
<p>We can display the harvest levels for both scenarios.</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># View the transition targets for the Harvest and No Harvest scenarios</span></span>
<span><span class="fu"><a href="../reference/datasheet.html">datasheet</a></span><span class="op">(</span><span class="va">myProject</span>, </span>
<span>          scenario <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Harvest"</span>, <span class="st">"No Harvest"</span><span class="op">)</span>, </span>
<span>          name <span class="op">=</span> <span class="st">"stsim_TransitionTarget"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   ScenarioId ProjectId ScenarioName ParentId ParentName TransitionGroupId</span></span>
<span><span class="co">## 1          2         1   No Harvest       NA       &lt;NA&gt;           Harvest</span></span>
<span><span class="co">## 2          3         1      Harvest       NA       &lt;NA&gt;           Harvest</span></span>
<span><span class="co">## 3          2         1   No Harvest       NA       &lt;NA&gt;           Harvest</span></span>
<span><span class="co">## 4          3         1      Harvest       NA       &lt;NA&gt;           Harvest</span></span>
<span><span class="co">##   Amount</span></span>
<span><span class="co">## 1      0</span></span>
<span><span class="co">## 2      0</span></span>
<span><span class="co">## 3     20</span></span>
<span><span class="co">## 4     20</span></span></code></pre>
</div>
</div>
</div>
<div class="section level2">
<h2 id="run-scenarios">Run Scenarios<a class="anchor" aria-label="anchor" href="#run-scenarios"></a>
</h2>
<div class="section level3">
<h3 id="setting-run-parameters-with-run">Setting run parameters with <code>run()</code><a class="anchor" aria-label="anchor" href="#setting-run-parameters-with-run"></a>
</h3>
<p>We will now run both scenarios using the <code><a href="../reference/run.html">run()</a></code> function
in <code>rsyncrosim</code>.</p>
<p>If we have a large model and we want to parallelize the run using
multiprocessing, we can modify the library-scoped “core_Multiprocessing”
datasheet. Since we are using five iterations in our model, we will set
the number of jobs to five so each multiprocessing core will run a
single iteration.</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load list of available library-scoped datasheets</span></span>
<span><span class="fu"><a href="../reference/datasheet.html">datasheet</a></span><span class="op">(</span><span class="va">myLibrary</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      scope                      name             displayName</span></span>
<span><span class="co">## 1  library               core_Backup                  Backup</span></span>
<span><span class="co">## 2  library             core_JlConfig                   Julia</span></span>
<span><span class="co">## 3  library      core_Multiprocessing         Multiprocessing</span></span>
<span><span class="co">## 4  library               core_Option                 Options</span></span>
<span><span class="co">## 5  library core_ProcessorGroupOption Processor Group Options</span></span>
<span><span class="co">## 6  library  core_ProcessorGroupValue  Processor Group Values</span></span>
<span><span class="co">## 7  library             core_PyConfig                  Python</span></span>
<span><span class="co">## 8  library              core_RConfig                       R</span></span>
<span><span class="co">## 9  library              core_Setting                Settings</span></span>
<span><span class="co">## 10 library        core_SpatialOption         Spatial Options</span></span>
<span><span class="co">## 11 library            core_SysFolder                 Folders</span></span></code></pre>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the library-scoped multiprocessing datasheet</span></span>
<span><span class="va">multiprocess</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datasheet.html">datasheet</a></span><span class="op">(</span><span class="va">myLibrary</span>, name <span class="op">=</span> <span class="st">"core_Multiprocessing"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check required inputs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">multiprocess</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 'data.frame':    1 obs. of  4 variables:</span></span>
<span><span class="co">##  $ EnableMultiprocessing  : logi FALSE</span></span>
<span><span class="co">##  $ MaximumJobs            : num 7</span></span>
<span><span class="co">##  $ EnableMultiScenario    : logi FALSE</span></span>
<span><span class="co">##  $ EnableCopyExternalFiles: logi NA</span></span></code></pre>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Enable multiprocessing</span></span>
<span><span class="va">multiprocess</span><span class="op">$</span><span class="va">EnableMultiprocessing</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span></span>
<span><span class="co"># Set maximum number of jobs to 5</span></span>
<span><span class="va">multiprocess</span><span class="op">$</span><span class="va">MaximumJobs</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span></span>
<span><span class="co"># Save multiprocessing configuration</span></span>
<span><span class="fu"><a href="../reference/saveDatasheet.html">saveDatasheet</a></span><span class="op">(</span>ssimObject <span class="op">=</span> <span class="va">myLibrary</span>, </span>
<span>              data <span class="op">=</span> <span class="va">multiprocess</span>, </span>
<span>              name <span class="op">=</span> <span class="st">"core_Multiprocessing"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Datasheet &lt;core_Multiprocessing&gt; saved</span></span></code></pre>
<p>Now, when we run our scenario, it will use the desired
multiprocessing configuration. Running a scenario generates a
corresponding new child scenario, called a <em>results scenario</em>,
which contains the results of the run along with a snapshot of all the
model inputs.</p>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run both scenarios</span></span>
<span><span class="va">myResultScenario</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="va">myProject</span>, </span>
<span>                        scenario <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Harvest"</span>, <span class="st">"No Harvest"</span><span class="op">)</span>, </span>
<span>                        summary <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Running scenario [3] Harvest"</span></span>
<span><span class="co">## [1] "Running scenario [2] No Harvest"</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="view-results">View results<a class="anchor" aria-label="anchor" href="#view-results"></a>
</h2>
<p>The next step is to view the output datasheets added to the result
scenario when it was run. To look at the results we first need to
retrieve the unique <code>scenarioId</code> for each child <em>result
scenario</em>.</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieve scenario IDs</span></span>
<span><span class="va">resultIDNoHarvest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">myResultScenario</span>, </span>
<span>                            <span class="va">ParentId</span> <span class="op">==</span> <span class="fu"><a href="../reference/scenarioId.html">scenarioId</a></span><span class="op">(</span><span class="va">myScenario</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">ScenarioId</span></span>
<span><span class="va">resultIDHarvest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">myResultScenario</span>, </span>
<span>                          <span class="va">ParentId</span> <span class="op">==</span> <span class="fu"><a href="../reference/scenarioId.html">scenarioId</a></span><span class="op">(</span><span class="va">myScenarioHarvest</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">ScenarioId</span></span></code></pre></div>
<p>We can now retrieve tabular output regarding the projected State
Class over time (for both scenarios combined) from the
<code>stsim_OutputStratumState</code> datasheet.</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieve output projected State Class for both Scenarios in tabular form</span></span>
<span><span class="va">outputStratumState</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datasheet.html">datasheet</a></span><span class="op">(</span></span>
<span>  <span class="va">myProject</span>, </span>
<span>  scenario <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">resultIDNoHarvest</span>, <span class="va">resultIDHarvest</span><span class="op">)</span>, </span>
<span>  name <span class="op">=</span> <span class="st">"stsim_OutputStratumState"</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we can get the State Class raster output using the
<code>datasheetRaster()</code> function (here for the Harvest scenario
only).</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieve the output State Class raster for the Harvest scenario at timestep 5</span></span>
<span><span class="va">myRastersTimestep5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datasheetSpatRaster.html">datasheetSpatRaster</a></span><span class="op">(</span>ssimObject <span class="op">=</span> <span class="va">myProject</span>, </span>
<span>                                          scenario <span class="op">=</span> <span class="va">resultIDHarvest</span>,</span>
<span>                                          datasheet <span class="op">=</span> <span class="st">"stsim_OutputSpatialState"</span>, </span>
<span>                                          timestep <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">myRastersTimestep5</span></span></code></pre></div>
<pre><code><span><span class="co">## class       : SpatRaster </span></span>
<span><span class="co">## dimensions  : 10, 10, 7  (nrow, ncol, nlyr)</span></span>
<span><span class="co">## resolution  : 1, 1  (x, y)</span></span>
<span><span class="co">## extent      : 0, 10, 0, 10  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">## coord. ref. : UTM Zone 10, Northern Hemisphere </span></span>
<span><span class="co">## sources     : sc.it1.ts5.tif  </span></span>
<span><span class="co">##               sc.it2.ts5.tif  </span></span>
<span><span class="co">##               sc.it3.ts5.tif  </span></span>
<span><span class="co">##               ... and 4 more source(s)</span></span>
<span><span class="co">## names       : sc.it1.ts5, sc.it2.ts5, sc.it3.ts5, sc.it4.ts5, sc.it5.ts5, sc.it6.ts5, ...</span></span></code></pre>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot raster for the first realization of timestep 5</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">myRastersTimestep5</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="a05_rsyncrosim_stsim_vignette_files/figure-html/view%20myRastersTimestep5-1.png" width="480" style="display: block; margin: auto auto auto 0;"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Colin Daniel, Josie Hughes, Valentin Lucet, Alex Embrey, Katie Birchard, Leonardo Frid, Tabitha Kennedy, Shreeram Senthivasan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
